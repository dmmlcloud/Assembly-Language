.386
STACK	SEGMENT USE16 STACK
	DB 	200 DUP(0)
STACK	ENDS
DATA	SEGMENT USE16
LIN	DB	'Please enter your username:$'
LIP	DB	'Please enter your password:$'
FIN	DB	'Please enter what you want:$'
in_name	DB	10,0,10 DUP(0)
in_pwd	DB	6,0,6 DUP(0)
PR1	DD	0
PR2	DD	0
APR	DD	0
RSA	DB	'A$'
RSB	DB	'B$'
RSC	DB	'C$'
RSD	DB	'D$'
RSF	DB	'F$'
QUIT	DB	'p$'
KONG	DB	10
AUTH	DB	0
MISN	DB	'Username error!$'
MISP	DB	'Password error!$'
BNAME	DB 	'LIU ZIYU',0,0
BPASS	DB 	'TEST',0,0
COUNTN	EQU	8
COUNTP	EQU	4
N	DD 	2
GN	DB	10,0,10 DUP(0)
S1	DB 	'SHOP1',0
GA1	DB 	'PEN',7 DUP(0)
	DW	35,56,70,25,?
GA2	DB	'BOOK',6 DUP(0)
	DW	12,30,25,5,?
S2	DB	'SHOP',0
GB1	DB	'BOOK',6 DUP(0)
	DW	12,28,20,15,?
GB2	DB	'PEN',7 DUP(0)
	DW	35,50,30,24,?
DATA ENDS

CODE	SEGMENT	USE16
ASSUME	DS:DATA,CS:CODE,SS:STACK
START:	MOV	AX, DATA
	MOV	DS, AX
RP:	LEA	DX, LIN
	MOV	AH, 9
	INT	21H
	LEA	DX, in_name
	MOV	AH, 10
	INT	21H
	CMP	in_name+2, 13
	JE	COS
	CMP	in_name+2, 'q'
	JE	EXIT
	MOV	DL, 13
	MOV	AH, 2
	INT 	21H
	MOV	DL, 10
	MOV	AH, 2
	INT	21H
	LEA	DX, LIP
	MOV	AH, 9
	INT	21H
	LEA	DX, in_pwd
	MOV	AH, 10
	INT	21H
	MOV	DL, 13
	MOV	AH, 2
	INT 	21H
	MOV	DL, 10
	MOV	AH, 2
	INT	21H
	MOV	AL, in_name+1
	CMP	AL, COUNTN
	JNE	UNMS
	MOV	CX, COUNTN
	LEA	SI, in_name+2
	LEA	DI, BNAME
	MOV	CX, COUNTN
RCM:	MOV	AL, [SI]
	CMP	AL, [DI]
	JNE	UNMS
	INC	SI
	INC	DI
	DEC	CX
	JE	EQ1
	JMP	RCM
EQ1:	MOV	AL, in_pwd+1
	CMP	AL, COUNTP
	JNE	PWMS
	LEA	SI, in_pwd+2
	LEA	DI, BPASS
	MOV	CX, COUNTP
RCM2:	MOV	AL, [SI]
	CMP	AL, [DI]
	JNE	PWMS
	INC	SI
	INC	DI
	DEC	CX
	JE	EQ2
	JMP	RCM2
EQ2:	MOV	AL, 1
	MOV	AUTH, AL
	JMP	FUNC3
COS:	MOV	AL, 0
	MOV	AUTH, AL
	JMP	FUNC3
FUNC3:	LEA	DX, FIN
	MOV	AH, 9
	INT	21H
	LEA	DX, GN
	MOV	AH, 10
	INT	21H
	MOV	DL, 13
	MOV	AH, 2
	INT 	21H
	MOV	DL, 10
	MOV	AH, 2
	INT	21H
	MOV	BX, 0
	CMP	GN+2, 13
	JE	RP
	MOV	CX, 0
	MOV	CL, [GN+1]
COMP:	LEA	SI, GN+2
	LEA	DI, [GA1+BX]
RCM3:	MOV	AL, [SI]
	CMP	AL, [DI]
	JNE	ALL
	INC	SI
	INC	DI
	DEC	CX
	JE	CPL
	JMP	RCM3
BCP:	CMP	AUTH, 0
	JE	NIN
	MOV	AX, WORD PTR [GA1+BX+10]
	CWDE
	MOV	ECX, EAX
	MOV	AX, WORD PTR [GA1+BX+14]
	CWDE
	IMUL	ECX, EAX
	MOV	AX, WORD PTR [GA1+BX+12]
	CWDE
	MOV	EDX, EAX
	MOV	AX, WORD PTR [GA1+BX+16]
	CWDE
	IMUL	EAX, EDX
	SUB	EAX, ECX
	IMUL	EAX, 100
	CDQ
	IDIV	ECX
	MOV	PR1, EAX
	MOV	BX, 0
	MOV	CX, 0
	MOV	CL, [GN+1]
COMP2:	LEA	SI, GN+2
	LEA	DI, [GB1+BX]
RCM4:	MOV	AL, [SI]
	CMP	AL, [DI]
	JNE	ALL2
	INC	SI
	INC	DI
	DEC	CX
	JE	CPL2
	JMP	RCM4
BCP2:	MOV	AX, WORD PTR [GB1+BX+10]
	CWDE
	MOV	ECX, EAX
	MOV	AX, WORD PTR [GB1+BX+14]
	CWDE
	IMUL	ECX, EAX
	MOV	AX, WORD PTR [GB1+BX+12]
	CWDE
	MOV	EDX, EAX
	MOV	AX, WORD PTR [GB1+BX+16]
	CWDE
	IMUL	EAX, EDX
	SUB	EAX, ECX
	IMUL	EAX, 100
	CDQ
	IDIV	ECX
	MOV	PR2, EAX
	MOV	EDX, PR1
	ADD	EAX, EDX
	CDQ
	MOV	EBX, 2
	IDIV	EBX
	MOV	APR, EAX
	JMP	FUNC4
CPL:	CMP	BYTE PTR [DI+1], 0
	JE	BCP
	JMP	ALL
CPL2:	CMP	BYTE PTR [DI+1], 0
	JE	BCP2
	JMP	ALL2	
NIN:	MOV	CL, [GN+1]
	LEA	SI, GN+2
PRN:	MOV	DX, [SI]
	MOV	AH, 2
	INT	21H
	INC	SI
	DEC	CL
	JNE	PRN
	MOV	DL, 13
	MOV	AH, 2
	INT 	21H
	MOV	DL, 10
	MOV	AH, 2
	INT	21H
	JMP	RP	
ALL:	CMP	BX, 40
	JE	FUNC3
	ADD	BX, 20
	JMP	COMP
ALL2:	ADD	BX,20
	JMP	COMP2
UNMS:	LEA	DX, MISN
	MOV	AH, 9
	INT	21H
	MOV	DL, 13
	MOV	AH, 2
	INT 	21H
	MOV	DL, 10
	MOV	AH, 2
	INT	21H
	JMP	RP
PWMS:	LEA	DX, MISP
	MOV	AH, 9
	INT	21H
	MOV	DL, 13
	MOV	AH, 2
	INT 	21H
	MOV	DL, 10
	MOV	AH, 2
	INT	21H
	JMP	RP
FUNC4:	CMP	AX, 90
	JGE	PA
	CMP	AX, 50
	JGE	PB
	CMP	AX, 20
	JGE	PC
	CMP	AX, 0
	JGE	PD
	JMP	PF
PA:	LEA	DX, RSA
	MOV	AH, 9
	INT	21H
	MOV	DL, 13
	MOV	AH, 2
	INT 	21H
	MOV	DL, 10
	MOV	AH, 2
	INT	21H
	JMP	RP
PB:	LEA	DX, RSB
	MOV	AH, 9
	INT	21H
	MOV	DL, 13
	MOV	AH, 2
	INT 	21H
	MOV	DL, 10
	MOV	AH, 2
	INT	21H
	JMP	RP
PC:	LEA	DX, RSC
	MOV	AH, 9
	INT	21H
	MOV	DL, 13
	MOV	AH, 2
	INT 	21H
	MOV	DL, 10
	MOV	AH, 2
	INT	21H
	JMP	RP
PD:	LEA	DX, RSD
	MOV	AH, 9
	INT	21H
	MOV	DL, 13
	MOV	AH, 2
	INT 	21H
	MOV	DL, 10
	MOV	AH, 2
	INT	21H
	JMP	RP
PF:	LEA	DX, RSF
	MOV	AH, 9
	INT	21H
	MOV	DL, 13
	MOV	AH, 2
	INT 	21H
	MOV	DL, 10
	MOV	AH, 2
	INT	21H
	JMP	RP
EXIT:	INT	21H
CODE	ENDS
	END	START
